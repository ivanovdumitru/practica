{"version":3,"sources":["TableForm.coffee"],"names":[],"mappings":"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","file":"TableForm.js","sourceRoot":"/source/","sourcesContent":["class TableForm\r\n\t@VERSION = '2.2.6'\r\n\t@default = {\r\n\t\tcontentType: false\r\n\t\tactionNotification: true\r\n\t\tdatePickerOptions:\r\n\t\t\tdateFormat: 'dd/mm/yy'\r\n\t\ttimePickerOptions:\r\n\t\t\tparse: 'loose'\r\n\t\t\ttimeFormat: 'HH:mm:ss'\r\n\t\tloadLength: 50\r\n\t\tafter: null\r\n\t\tonSubmit: null\r\n\t\tonComplete: null\r\n\t\tonCancel: null\r\n\t\tonActionNotification: null\r\n\t\tonDelete: null\r\n\t\tsendCSRFTokenHeader: true\r\n\t}\r\n\tconstructor: (data) ->\r\n\t\t@edit = false\r\n\t\t@form = $('<div class=\"form\" />')\r\n\t\t@table = null\r\n\t\t@pinned = false\r\n\t\t@formData = null\r\n\t\t@getData = null\r\n\t\t@request = null\r\n\t\t@fields = []\r\n\t\t@actions = []\r\n\t\t@template = swig.compile('<form{% for attr, value in form.attrs %} {{attr}}=\"{{value}}\"{% endfor %}> {% if form.name %}<p class=\"name {{form.name.attrs.class}}\">{{form.name.label}}</p>{% endif %} {% for field in fields %} {% if field.type == \"hidden\" %}<input type=\"hidden\" name=\"{{field.name}}\" value=\"{{field.value}}\" />{% else %} <div class=\"field{% if field.fields.length > 1 %} multiple{% endif %}{% if field.attrs.class %} {{field.attrs.class}}{% endif %}\">{% if field.group %}<p class=\"group{% if field.group.class %} {{field.group.class}}{% endif %}\">{% if field.group.label %}{{field.group.label}}{% else %}{{field.group}}{% endif %}</p>{% endif %}{% for input in field.fields %}{% if input.label and (not input.label.position or input.label.position and input.label.position == \"before\") %} <label for=\"{{_prefix}}input_{{input.name}}\"{% if input.label.class or input.required %} class=\"{% if input.required %}required{% endif %}{% if input.label.class %} {{input.label.class}}{% endif %}\"{% endif %}>{% if input.label.text %}{{input.label.text}}{% else %}{{input.label}}{% endif %}</label>{% endif %}{% if input.type == \"textarea\" %} <textarea id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\" {% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %}{% if input.length %} data-length=\"{{input.length}}\"{% endif %}>{{input.value}}</textarea>{% elif input.type == \"date\" %} <div class=\"date-picker\" id=\"{{_prefix}}input_{{input.name}}\"><input type=\"text\" name=\"{{input.name}}\" value=\"{{input.value}}\" {% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %} /></div>{% elif input.type == \"time\" %} <div class=\"time-picker\" id=\"{{_prefix}}input_{{input.name}}\"><input type=\"text\" name=\"{{input.name}}\" value=\"{{input.value}}\"/></div>{% elif input.type == \"select\" %} <select id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\" {% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %}>{% for value, label in input.options %}<option value=\"{{value}}\"{% if value == input.value %} selected=\"selected\"{% endif %}>{{label}}</option>{% endfor %}</select>{% elif input.type == \"related\" %} <input type=\"hidden\" id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\" data-select=\"related\" value=\"{{input.value}}\" data-text=\"{{input.text}}\" data-url=\"{{input.url}}\" data-placeholder=\"{{input.placeholder}}\" data-order=\"{{input.order}}\" data-results=\\'{{input.results}}\\'{% if input.related %} data-related=\\'{{input.related|json}}\\'{% endif %}{% if input.children %} data-children=\\'{{input.children|json}}\\'{% endif %}{% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %}/>{% elif input.type == \"checkbox\" %} <input type=\"checkbox\" id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\"{% if input.value %} checked=\"checked\" {% endif %}{% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %} />{% elif input.type == \"text\" or input.type == \"digits\" %} <input type=\"text\" id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\" value=\"{{input.value}}\" data-type=\"{{input.type}}\"{% if input.length %} data-length=\"{{input.length}}\"{% endif %}{% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %} />{% else %} <input type=\"{{input.type}}\" id=\"{{_prefix}}input_{{input.name}}\" name=\"{{input.name}}\" value=\"{{input.value}}\"{% for attr, value in input.attrs %} {{attr}}=\"{{value}}\"{% endfor %}{% if input.length %} data-length=\"{{input.length}}\"{% endif %} />{% endif %}{% if input.label and (input.label.position and input.label.position == \"after\") %} <label for=\"{{_prefix}}input_{{input.name}}\"{% if input.label.class or input.required %} class=\"{% if input.required %}required{% endif %}{% if input.label.class %} {{input.label.class}}{% endif %}\"{% endif %}>{% if input.label.text %}{{input.label.text}}{% else %}{{input.label}}{% endif %}</label>{% endif %}{% endfor %} <span class=\"error-text\"></span></div>{% endif %}{% endfor %}{% if actions.length %}{% for action in actions %} <button type=\"button\" class=\"btn btn-{{action.id}}{% if action.class %} {{action.class}}{% endif %}\"{% for attr, value in action.attrs %} {{attr}}=\"{{value}}\"{% endfor %}>{{action.label}}</button>{% endfor %}{% else %} <button type=\"button\" class=\"btn btn-success btn-ok\">Ok</button> <button type=\"button\" class=\"btn btn-danger btn-cancel\">Cancel</button>{% endif %}</form>')\r\n\r\n\t\tfor prop, value of @constructor.default\r\n\t\t\t@[prop] = value\r\n\r\n\t\tfor i of data\r\n\t\t\tif i of @\r\n\t\t\t\t@[i] = data[i]\r\n\r\n\t\tif @formData.attrs? and @formData.attrs.id\r\n\t\t\t@prefix = @formData.attrs.id\r\n\t\telse\r\n\t\t\t@prefix = \"uid_#{@uid()}\"\r\n\t\t\twhile $(\"[id^='#{@prefix}']\").length\r\n\t\t\t\t@prefix = \"uid_#{@uid()}\"\r\n\t\treturn\r\n\r\n\tgetCsrfToken: ->\r\n\t\tnameEQ = \"csrftoken=\"\r\n\t\tca = document.cookie.split(\";\")\r\n\t\ti = 0\r\n\t\twhile i < ca.length\r\n\t\t\tc = ca[i]\r\n\t\t\tc = c.substring(1, c.length)  while c.charAt(0) is \" \"\r\n\t\t\treturn c.substring(nameEQ.length, c.length).replace(/\"/g, '')  if c.indexOf(nameEQ) is 0\r\n\t\t\ti++\r\n\t\treturn ca\r\n\r\n\tuid: ->\r\n\t\tMath.floor((1 + Math.random()) * 0x100000000).toString(16).substring(1)\r\n\r\n\tbindForm: ->\r\n\t\ttableForm = @\r\n\t\t@form.find(\":input\").change ->\r\n\t\t\ttableForm.form.closest('tr').addClass('edited')\r\n\t\t\treturn\r\n\r\n\t\t@form.on 'focus', 'input, textarea', ->\r\n\t\t\ttry\r\n\t\t\t\t@setSelectionRange(0, @value.length)\r\n\t\t\treturn\r\n\r\n\t\t@form.on 'keypress', 'input, textarea', (e) ->\r\n\t\t\tinput = $(e.target)\r\n\t\t\tif input.data('length')?\r\n\t\t\t\tif input.val().length >= parseInt(input.data('length'))\r\n\t\t\t\t\treturn false\r\n\t\t\tif input.data('type')?\r\n\t\t\t\tswitch input.data('type')\r\n\t\t\t\t\twhen 'digits'\r\n\t\t\t\t\t\tcharCode = if e.charCode? then e.charCode else e.keyCode\r\n\t\t\t\t\t\treturn false if charCode and (charCode > 57 or charCode < 48)\r\n\t\t\treturn\r\n\r\n\t\t@form.on 'keyup', 'input', (e) ->\r\n\t\t\tif e.keyCode == 13\r\n\t\t\t\tnext = $(e.target).nextAll('input, textarea, select').not('.skip-focus').first()\r\n\t\t\t\tif not next.length\r\n\t\t\t\t\tnext = $(e.target).closest('.field').nextAll('.field').not('.skip-focus').first().find('input, textarea, select')\r\n\t\t\t\tif not next.length\r\n\t\t\t\t\tnext = tableForm.form.find('.btn-ok')\r\n\t\t\t\tnext.first().focus()\r\n\r\n\t\tif $.fn.datepicker?\r\n\t\t\t@form.find('.date-picker input').datepicker(@datePickerOptions)\r\n\t\t\t@form.find('.date-picker').click ->\r\n\t\t\t\t$(@).find('input').datepicker('show')\r\n\t\t\t\treturn\r\n\r\n\t\tif $.fn.timepicker?\r\n\t\t\t@form.find('.time-picker input').timepicker(@timePickerOptions)\r\n\t\t\t@form.find('.time-picker').click ->\r\n\t\t\t\t$(@).find('input').timepicker('show')\r\n\t\t\t\treturn\r\n\r\n\t\t@form.find('[data-select=related]').each ->\r\n\t\t\t$(@).select2($.extend(true, (if $(@).data('options') then $(@).data('options') else {}), {\r\n\t\t\t\tinitSelection: (element, callback) ->\r\n\t\t\t\t\trelated = element.data()\r\n\t\t\t\t\tdata = {id: element.val(), text: related.text}\r\n\t\t\t\t\tcallback(data);\r\n\t\t\t\t\treturn\r\n\t\t\t\tquery: (queryObj) ->\r\n\t\t\t\t\trelated = queryObj.element.data()\r\n\t\t\t\t\tdata = {more: false, results: []}\r\n\t\t\t\t\tif related.related?\r\n\t\t\t\t\t\tif typeof related.related == 'object'\r\n\t\t\t\t\t\t\tpostData = $.extend({}, related.related)\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tpostData = {related: related.related}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tpostData = {}\r\n\t\t\t\t\tpostData.select = true\r\n\t\t\t\t\tpostData.ordering = related.order\r\n\t\t\t\t\tpostData.text = queryObj.term\r\n\t\t\t\t\tpostData.start = (queryObj.page - 1) * tableForm.loadLength\r\n\t\t\t\t\tpostData.length = tableForm.loadLength\r\n\t\t\t\t\tpostData[related.results.term] = queryObj.term\r\n\t\t\t\t\t$.getJSON(\r\n\t\t\t\t\t\trelated.url,\r\n\t\t\t\t\t\tpostData,\r\n\t\t\t\t\t\t(list) ->\r\n\t\t\t\t\t\t\tdata.more = list.length == tableForm.loadLength\r\n\t\t\t\t\t\t\tfor element in list\r\n\t\t\t\t\t\t\t\tif related.format?\r\n\t\t\t\t\t\t\t\t\telement = related.format(element)\r\n\t\t\t\t\t\t\t\tdata.results.push({id: element[related.results.id].toString(), text: element[related.results.text].toString()})\r\n\t\t\t\t\t\t\tqueryObj.callback(data)\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t)\r\n\t\t\t\t\treturn\r\n\t\t\t})).change((e) ->\r\n\t\t\t\telement = $(e.target)\r\n\t\t\t\trelated = element.data()\r\n\t\t\t\tif related.children?\r\n\t\t\t\t\tfor child in related.children\r\n\t\t\t\t\t\tselect = tableForm.form.find(\"[name=#{child}]\")\r\n\t\t\t\t\t\trelatedData = select.data()\r\n\t\t\t\t\t\tif related.results.reference? and relatedData['related']? and typeof relatedData['related'] == 'object'\r\n\t\t\t\t\t\t\trelatedData['related'][related.results.reference] = element.val()\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\trelatedData['related'] = element.val()\r\n\t\t\t\t\t\tif not relatedData['relatedElements']?\r\n\t\t\t\t\t\t\trelatedData['relatedElements'] = {}\r\n\t\t\t\t\t\trelatedData['relatedElements'][element.attr('name')] = !!element.val()\r\n\t\t\t\t\t\tselect.data(relatedData)\r\n\t\t\t\t\t\tif e.added?\r\n\t\t\t\t\t\t\tselect.select2('val', '').trigger('change')\r\n\t\t\t\t\t\tdisable = false\r\n\t\t\t\t\t\tfor state, value of relatedData['relatedElements']\r\n\t\t\t\t\t\t\tdisable = true if not value\r\n\t\t\t\t\t\tselect.prop('disabled', disable)\r\n\t\t\t\treturn\r\n\t\t\t).trigger('change')\r\n\r\n\t\t@form.find('.btn-cancel').click ->\r\n\t\t\tif tableForm.onCancel?\r\n\t\t\t\tcb = tableForm.onCancel(tableForm)\r\n\t\t\t\tif cb? and not cb\r\n\t\t\t\t\treturn\r\n\t\t\tif tableForm.table?\r\n\t\t\t\ttableForm.table.closeRowContainer(tableForm.form.closest('tr.row-content').index())\r\n\t\t\treturn\r\n\r\n\t\t@form.find('.btn-ok').click ->\r\n\t\t\ttableForm.sendData()\r\n\t\t\treturn\r\n\r\n\t\tfor action in @actions\r\n\t\t\tif action.callback?\r\n\t\t\t\tdo (action) ->\r\n\t\t\t\t\ttableForm.form.find(\".btn-#{action.id}\").click ->\r\n\t\t\t\t\t\taction.callback(tableForm)\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\treturn\r\n\r\n\t\t@form.on 'submit', ->\r\n\t\t\ttableForm.sendData()\r\n\t\t\treturn false\r\n\t\treturn\r\n\r\n\trender: ->\r\n\t\tform = @\r\n\t\tif @edit and not @form.html() and not @request?\r\n\t\t\t@form.html($('<em />').text('Loading form data'))\r\n\t\t\t@formData.attrs.action = \"#{@formData.attrs.action}#{@edit}/\"\r\n\t\t\t@loadData()\r\n\t\telse\r\n\t\t\tfieldData = []\r\n\t\t\tfor field in @fields\r\n\t\t\t\tif field.type? and field.type == 'hidden'\r\n\t\t\t\t\tfieldData.push field\r\n\t\t\t\tif field instanceof Array\r\n\t\t\t\t\tfieldData.push {\r\n\t\t\t\t\t\tfields: field\r\n\t\t\t\t\t}\r\n\t\t\t\telse if not field.fields?\r\n\t\t\t\t\tfieldData.push {\r\n\t\t\t\t\t\tfields: [field]\r\n\t\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tfieldData.push field\r\n\t\t\t\tfor input in fieldData[fieldData.length - 1].fields\r\n\t\t\t\t\tif input.type == 'related' and input.children? and typeof input.children == 'string'\r\n\t\t\t\t\t\tinput.children = [input.children]\r\n\t\t\t\t\tif input.value?\r\n\t\t\t\t\t\tif input.type == 'date' and $.fn.datepicker? and new Date(input.value).toString() != 'Invalid Date'\r\n\t\t\t\t\t\t\tinput.value = $.datepicker.formatDate(@datePickerOptions.dateFormat, new Date(input.value))\r\n\t\t\t\t\t\tif input.type == 'time' and $.fn.timepicker?\r\n\t\t\t\t\t\t\ttime = new Date(input.value)\r\n\t\t\t\t\t\t\tif time.toString() == 'Invalid Date' and input.value.match(/(\\d{2})(\\.\\d{3})?/g)\r\n\t\t\t\t\t\t\t\ttime = new Date(new Date().toISOString().substr(0, 11) + input.value.match(/(\\d{2})(\\.\\d{3})?/g).join(':') + 'Z')\r\n\t\t\t\t\t\t\tif time.toString() != 'Invalid Date'\r\n\t\t\t\t\t\t\t\tinput.value = $.datepicker.formatTime(@timePickerOptions.timeFormat, {hour: time.getUTCHours(), minute: time.getUTCMinutes(), second: time.getUTCSeconds()})\r\n\t\t\t@form.html($(@template({form: @formData, fields: fieldData, actions: @actions, _prefix: \"#{@prefix}_\"})))\r\n\t\t\t@bindForm()\r\n\t\t\tif @table? and @form.closest('.row-content').length\r\n\t\t\t\t@table.scrollRowContainer(@form.closest('.row-content'))\r\n\t\t\tsetTimeout(() ->\r\n\t\t\t\tif form.form.find('.auto-focus').length\r\n\t\t\t\t\tform.form.find('.auto-focus').focus()\r\n\t\t\t\telse\r\n\t\t\t\t\tform.form.find(':input:visible:not([disabled]):first').focus()\r\n\t\t\t\tif form.after?\r\n\t\t\t\t\tform.after(form)\r\n\t\t\t\treturn\r\n\t\t\t, 0)\r\n\t\treturn @form\r\n\r\n\tdelData: ->\r\n\t\tform = @\r\n\t\tcontinueCallback = ->\r\n\t\t\tdata = []\r\n\t\t\tform.formData.attrs.action = \"#{form.formData.attrs.action}#{form.edit}/\"\r\n\t\t\tform.request = $.ajax({\r\n\t\t\t\turl: form.formData.attrs.action\r\n\t\t\t\tdata: JSON.stringify(data)\r\n\t\t\t\ttype: if form.formData.attrs.method? then form.formData.attrs.method else 'DELETE'\r\n\t\t\t\tcontentType: if form.formData.contentType? then form.formData.contentType else form.contentType\r\n\t\t\t\tdataType: 'json'\r\n\t\t\t\theaders: if form.sendCSRFTokenHeader then {'X-CSRFToken': form.getCsrfToken()} else {}\r\n\t\t\t\tcomplete: (response) ->\r\n\t\t\t\t\tform.request = null\r\n\t\t\t\t\tif form.actionNotification\r\n\t\t\t\t\t\tif form.onActionNotification?\r\n\t\t\t\t\t\t\tcb = form.onActionNotification(response, form)\r\n\t\t\t\t\t\t\tif cb? and not cb\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\tif response.status == 204\r\n\t\t\t\t\t\tif form.actionNotification and not form.onActionNotification?\r\n\t\t\t\t\t\t\talert 'Deleted!'\r\n\t\t\t\t\t\tform.table.resetTable()\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tconsole.error 'unknown status'\r\n\t\t\t\t\treturn\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\tif @edit and not @request?\r\n\t\t\tif @onDelete?\r\n\t\t\t\tcb = @onDelete(form, continueCallback)\r\n\t\t\t\tif cb? and not cb\r\n\t\t\t\t\treturn\r\n\t\t\telse if not confirm('You are sure?')\r\n\t\t\t\treturn\r\n\t\t\tcontinueCallback()\r\n\t\treturn\r\n\r\n\tloadData: ->\r\n\t\tform = @\r\n\t\tif not @request?\r\n\t\t\t@request = $.getJSON(@formData.attrs.action, {},\r\n\t\t\t\t(fields) ->\r\n\t\t\t\t\tif form.getData?\r\n\t\t\t\t\t\tfields = form.getData(fields)\r\n\t\t\t\t\tfor fieldData in form.fields\r\n\t\t\t\t\t\tif fieldData.fields? or fieldData instanceof Array\r\n\t\t\t\t\t\t\tfor input in (if fieldData.fields? then fieldData.fields else fieldData)\r\n\t\t\t\t\t\t\t\tif fields[input.name]?\r\n\t\t\t\t\t\t\t\t\tform.fieldValue(input, fields)\r\n\t\t\t\t\t\telse if fields[fieldData.name]?\r\n\t\t\t\t\t\t\tform.fieldValue(fieldData, fields)\r\n\t\t\t\t\tform.request = null\r\n\t\t\t\t\tform.render()\r\n\t\t\t\t\treturn\r\n\t\t\t)\r\n\t\treturn\r\n\r\n\tfieldValue: (field, value) ->\r\n\t\tif field.name? and value[field.name]?\r\n\t\t\tif field.type == 'related' and value[field.text]?\r\n\t\t\t\tfield.text = value[field.text]\r\n\t\t\telse if field.type == 'date' and new Date(value[field.name]).toString() != 'Invalid Date'\r\n\t\t\t\tvalue[field.name] = new Date(value[field.name])\r\n\t\t\telse if field.type == 'time' and value[field.name].length >= 4\r\n\t\t\t\ttime = value[field.name].match(/(\\d{2})(\\.\\d{3})?/g)\r\n\t\t\t\tvalue[field.name] = new Date(new Date().toISOString().substr(0, 11) + time.join(':') + 'Z')\r\n\t\t\tfield.value = value[field.name]\r\n\t\treturn\r\n\r\n\tsendData: ->\r\n\t\tif @onSubmit?\r\n\t\t\tcb = @onSubmit(@)\r\n\t\t\tif cb? and not cb\r\n\t\t\t\treturn\r\n\t\tif not @request?\r\n\t\t\tdata = {}\r\n\t\t\ttableForm = @\r\n\t\t\tfor field in @form.find('[name]')\r\n\t\t\t\tif $(field).parent().is('.date-picker')\r\n\t\t\t\t\tfieldDate = $(field).attr('name')\r\n\t\t\t\t\tif $(field).datepicker('getDate')\r\n\t\t\t\t\t\tdate = $(field).datepicker('getDate')\r\n\t\t\t\t\t\tdate.setMinutes(-date.getTimezoneOffset())\r\n\t\t\t\t\t\tdata[fieldDate] = date.toISOString().match(/^[^T]+/g)[0]\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdata[fieldDate] = ''\r\n\t\t\t\telse if $(field).parent().is('.time-picker')\r\n\t\t\t\t\tfieldDate = $(field).attr('name')\r\n\t\t\t\t\tif $(field).timepicker('getDate')\r\n\t\t\t\t\t\tdata[fieldDate] = $(field).val().match(/(\\d{2}:\\d{2}(:\\d{2})?)/g)\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdata[fieldDate] = ''\r\n\t\t\t\telse if $(field).attr('type') == 'checkbox'\r\n\t\t\t\t\tif $(field).is(':checked')\r\n\t\t\t\t\t\tdata[$(field).attr('name')] = if $(field).val() then $(field).val() else 'on'\r\n\t\t\t\telse\r\n\t\t\t\t\tdata[$(field).attr('name')] = $(field).val()\r\n\t\t\tcontentType = if @formData.contentType? then @formData.contentType else @contentType\r\n\t\t\t@request = $.ajax({\r\n\t\t\t\turl: @formData.attrs.action\r\n\t\t\t\tdata: if contentType == 'application/json' then JSON.stringify(data) else data\r\n\t\t\t\ttype: if @formData.attrs.method? then @formData.attrs.method else (if @edit then 'PUT' else 'POST')\r\n\t\t\t\tcontentType: contentType\r\n\t\t\t\tdataType: 'json'\r\n\t\t\t\theaders: if @sendCSRFTokenHeader then {'X-CSRFToken': @getCsrfToken()} else {}\r\n\t\t\t\tcomplete: (response) ->\r\n\t\t\t\t\ttableForm.request = null\r\n\t\t\t\t\tif tableForm.onComplete?\r\n\t\t\t\t\t\tcbReturn = tableForm.onComplete(tableForm, response)\r\n\t\t\t\t\t\tif cbReturn? and not cbReturn\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\ttableForm.form.find('.field').removeClass('error').find('.error-text').text('')\r\n\t\t\t\t\tif response.status in [200, 201]\r\n\t\t\t\t\t\tif tableForm.actionNotification\r\n\t\t\t\t\t\t\tif tableForm.onActionNotification?\r\n\t\t\t\t\t\t\t\tcb = tableForm.onActionNotification(response, tableForm)\r\n\t\t\t\t\t\t\t\tif cb? and not cb\r\n\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\talert if response.status == 200 then 'Updated!' else 'Added!'\r\n\t\t\t\t\t\ttableForm.table.closeRowContainer(tableForm.form.closest('tr').index(), true)\r\n\t\t\t\t\t\ttableForm.table.resetTable()\r\n\t\t\t\t\telse if response.status == 400\r\n\t\t\t\t\t\tif '__all__' of response.responseJSON\r\n\t\t\t\t\t\t\tfield = tableForm.form.find('[name]')\r\n\t\t\t\t\t\t\tif field.length\r\n\t\t\t\t\t\t\t\tfieldContainer = $(field).parent()\r\n\t\t\t\t\t\t\t\tfieldContainer.addClass('error')\r\n\t\t\t\t\t\t\t\tfieldContainer.find('.error-text').text(response.responseJSON['__all__'].join(', '))\r\n\t\t\t\t\t\tfor field in tableForm.form.find('[name]')\r\n\t\t\t\t\t\t\tfield = $(field)\r\n\t\t\t\t\t\t\tfieldContainer = field.parent()\r\n\t\t\t\t\t\t\tif fieldContainer.is('.date-picker')\r\n\t\t\t\t\t\t\t\tfieldContainer = fieldContainer.parent()\r\n\t\t\t\t\t\t\tif field.attr('name') of response.responseJSON\r\n\t\t\t\t\t\t\t\tfieldContainer.addClass('error')\r\n\t\t\t\t\t\t\t\ttext = if fieldContainer.hasClass('multiple') and fieldContainer.find('.error-text').text() then \"#{fieldContainer.find('.error-text').text()}, \" else ''\r\n\t\t\t\t\t\t\t\tfieldContainer.find('.error-text').text(text + response.responseJSON[field.attr('name')].join(', '))\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tconsole.error 'unknown status'\r\n\t\t\t\t\tif tableForm.table?\r\n\t\t\t\t\t\ttableForm.table.body.trigger('scroll')\r\n\t\t\t\t\treturn\r\n\t\t\t})\r\n\t\treturn\r\n"]}